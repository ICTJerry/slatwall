"use strict";angular.module("slatwalladmin",["ngSlatwall","ui.bootstrap","ngAnimate","ngRoute"]).config(["$provide","$logProvider","$filterProvider","$httpProvider","$routeProvider","$injector","$locationProvider","datepickerConfig","datepickerPopupConfig",function(e,t,n,o,a,l,r,i,s){i.showWeeks=!1,i.format="MMM dd, yyyy hh:mm a",s.toggleWeeksText=null,slatwallAngular.hashbang&&r.html5Mode(!1).hashPrefix("!"),e.constant("baseURL",$.slatwall.getConfig().baseURL);var c=$.slatwall.getConfig().baseURL+"/admin/client/partials/";e.constant("partialsPath",c),e.constant("productBundlePartialsPath",c+"productbundle/"),angular.forEach(slatwallAngular.constantPaths,function(t,n){var o=t.charAt(0).toLowerCase()+t.slice(1)+"PartialsPath",a=c+t.toLowerCase()+"/";e.constant(o,a)}),t.debugEnabled($.slatwall.getConfig().debugFlag),n.register("likeFilter",function(){return function(e){return angular.isDefined(e)&&angular.isString(e)?e.replace(new RegExp("%","g"),""):void 0}}),n.register("truncate",function(){return function(e,t,n){if(isNaN(t))return e;if(0>=t)return"";if(e&&e.length>t){if(e=e.substring(0,t),n)for(;" "===e.charAt(e.length-1);)e=e.substr(0,e.length-1);else{var o=e.lastIndexOf(" ");-1!==o&&(e=e.substr(0,o))}return e+"..."}return e}}),o.interceptors.push("slatwallInterceptor"),a.when("/entity/:entityName/",{template:function(e){var t=l.has("sw"+e.entityName+"ListDirective");return t?"<sw-"+e.entityName.toLowerCase()+"-list>":"<sw-list></sw-list>"},controller:"routerController"}).when("/entity/:entityName/:entityID",{template:function(e){var t=l.has("sw"+e.entityName+"DetailDirective");return t?"<sw-"+e.entityName.toLowerCase()+"-detail>":"<sw-detail></sw-detail>"},controller:"routerController"}).otherwise({templateUrl:$.slatwall.getConfig().baseURL+"/admin/client/js/partials/otherwise.html"})}]).run(["$rootScope","$filter","$anchorScroll","$slatwall","dialogService",function(e,t,n,o,a){n.yOffset=100,e.openPageDialog=function(e){a.addPageDialog(e)},e.closePageDialog=function(e){a.removePageDialog(e)},e.loadedResourceBundle=!1,e.loadedResourceBundle=o.hasResourceBundle();var l=e.$watch("loadedResourceBundle",function(t,n){t!==n&&(e.$broadcast("hasResourceBundle"),l())})}]).filter("entityRBKey",["$slatwall",function(e){return function(t){return angular.isDefined(t)&&angular.isString(t)?(t=t.replace("_","").toLowerCase(),t=e.getRBKey("entity."+t)):void 0}}]),angular.module("slatwalladmin").factory("alertService",["$timeout",function(e){var t=[],n={addAlert:function(n){t.push(n),e(function(){t.splice(0,1)},3500)},addAlerts:function(n){for(var o in n)t.push(n[o]),e(function(){t.splice(0,1)},3500)},formatMessagesToAlerts:function(t){var n=[];for(var o in t){var a={msg:t[o].message,type:t[o].messageType};n.push(a),"success"===a.type||"error"===a.type?(e(function(){a.fade=!0},3500),a.dismissable=!1):(a.fade=!1,a.dismissable=!0)}return n},getAlerts:function(){return t},removeAlert:function(e){for(var n in t)t[n]===e&&delete t[n]},removeOldestAlert:function(){_alert.splice(0,1)}};return n}]),angular.module("slatwalladmin").controller("alertController",["$scope","alertService",function(e,t){e.$id="alertController",e.alerts=t.getAlerts()}]),angular.module("slatwalladmin").controller("collections",["$scope","$location","$log","$timeout","$slatwall","collectionService","metadataService","paginationService",function(e,t,n,o,a,l,r,i){e.$id="collectionsController";var s=function(){for(var e={},t=window.location.search.substring(1),n=t.split("&"),o=0;o<n.length;o++){var a=n[o].split("=");if("undefined"==typeof e[a[0]])e[a[0]]=a[1];else if("string"==typeof e[a[0]]){var l=[e[a[0]],a[1]];e[a[0]]=l}else e[a[0]].push(a[1])}return e}();e.collectionID=s.collectionID,e.currentPage=i.getCurrentPage(),e.pageShow=i.getPageShow(),e.pageStart=i.getPageStart,e.pageEnd=i.getPageEnd,e.recordsCount=i.getRecordsCount,e.autoScrollPage=1,e.autoScrollDisabled=!1,e.appendToCollection=function(){if("Auto"===e.pageShow&&(n.debug("AppendToCollection"),e.autoScrollPage<e.collection.totalPages)){e.autoScrollDisabled=!0,e.autoScrollPage++;var t=a.getEntity("collection",{id:e.collectionID,currentPage:e.autoScrollPage,pageShow:50});t.then(function(t){e.collection.pageRecords=e.collection.pageRecords.concat(t.pageRecords),e.autoScrollDisabled=!1},function(e){})}},e.keywords="",e.loadingCollection=!1;var c;e.searchCollection=function(t){c&&o.cancel(c),c=o(function(){n.debug("search with keywords"),n.debug(e.keywords),i.setCurrentPage(1),e.loadingCollection=!0,e.getCollection()},500)},e.getCollection=function(){var t=50;"Auto"!==e.pageShow&&(t=e.pageShow);var n=a.getEntity("collection",{id:e.collectionID,currentPage:e.currentPage,pageShow:t,keywords:e.keywords});n.then(function(t){e.collection=t,e.collectionInitial=angular.copy(e.collection),angular.isUndefined(e.collectionConfig)&&(e.collectionConfig=angular.fromJson(e.collection.collectionConfig)),angular.isUndefined(e.collectionConfig.filterGroups)&&(e.collectionConfig.filterGroups=[{filterGroup:[]}]),l.setFilterCount(d()),e.loadingCollection=!1},function(e){})},e.getCollection();var u=e.$watch("collection",function(t,n){if(t!==n){if(angular.isUndefined(e.filterPropertiesList)){e.filterPropertiesList={};var o=a.getFilterPropertiesByBaseEntityName(e.collectionConfig.baseEntityAlias);o.then(function(t){r.setPropertiesList(t,e.collectionConfig.baseEntityAlias),e.filterPropertiesList[e.collectionConfig.baseEntityAlias]=r.getPropertiesListByBaseEntityAlias(e.collectionConfig.baseEntityAlias),r.formatPropertiesList(e.filterPropertiesList[e.collectionConfig.baseEntityAlias],e.collectionConfig.baseEntityAlias)})}u()}});e.setCollectionForm=function(t){e.collectionForm=t},e.collectionDetails={isOpen:!1,openCollectionDetails:function(){e.collectionDetails.isOpen=!0}},e.errorMessage={};var d=function(t){var n=0;angular.isDefined(t)||(t=e.collectionConfig.filterGroups[0].filterGroup);for(var o in t)if(t[o].$$isNew||angular.isDefined(t[o].filterGroup)){if(!angular.isDefined(t[o].filterGroup))break;n+=d(t[o].filterGroup)}else n++;return n};e.saveCollection=function(){o(function(){n.debug("saving Collection");var t="collection",o=e.collection;if(n.debug(e.collectionConfig),p(e.collectionForm)){var r=l.stringifyJSON(e.collectionConfig);n.debug(r);var s=angular.copy(o);s.collectionConfig=r,delete s.pageRecords;var c=a.saveEntity(t,o.collectionID,s);c.then(function(t){e.errorMessage={},i.setCurrentPage(1),e.getCollection(),e.collectionDetails.isOpen=!1},function(t){angular.forEach(t.errors,function(t,n){e.collectionForm[n].$invalid=!0,e.errorMessage[n]=t[0]})})}l.setFilterCount(d())})};var p=function(t){n.debug("validateForm");var o=!0;for(var a in t)if("$"!=a[0]){if(t[a].$invalid){o=!1;for(var l in t[a].$error)"required"==l&&(e.errorMessage[a]="This field is required")}t[a].$pristine&&t[a].$setViewValue(angular.isUndefined(t[a].$viewValue)?"":t[a].$viewValue)}return o};e.copyExistingCollection=function(){e.collection.collectionConfig=e.selectedExistingCollection},e.setSelectedExistingCollection=function(t){e.selectedExistingCollection=t},e.setSelectedFilterProperty=function(t){e.selectedFilterProperty=t},e.filterCount=l.getFilterCount}]),angular.module("slatwalladmin").controller("collectionsTabController",["$scope",function(e){}]),angular.module("slatwalladmin").controller("confirmationController",["$scope","$log","$modalInstance",function(e,t,n){e.deleteEntity=function(n){t.debug("Deleting an entity."),t.debug(e.entity),this.close()},e.close=function(){n.close()},e.cancel=function(){n.dismiss("cancel")}}]),angular.module("slatwalladmin").controller("create-bundle-controller",["$scope","$location","$log","$rootScope","$window","$slatwall","dialogService","alertService","productBundleService","formService","partialsPath",function(e,t,n,o,a,l,r,i,s,c,u){function d(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}e.partialsPath=u,e.$id="create-bundle-controller",angular.isDefined(e.scrollToTopOfDialog)&&e.scrollToTopOfDialog();var p=d("productID"),g=function(){e.product=l.newProduct();var t=l.newBrand(),n=l.newProductType();e.product.$$setBrand(t),e.product.$$setProductType(n),e.product.$$addSku(),e.product.data.skus[0].data.productBundleGroups=[]};if(e.productBundleGroup,angular.isDefined(p)&&""!==p){var f=l.getProduct({id:p});f.promise.then(function(){n.debug(f.value),f.value.$$getSkus().then(function(){f.value.data.skus[0].$$getProductBundleGroups().then(function(){e.product=f.value,angular.forEach(e.product.data.skus[0].data.productBundleGroups,function(e){e.$$getProductBundleGroupType(),s.decorateProductBundleGroup(e),e.data.$$editing=!1})})})},g())}else g();e.saveProductBundle=function(t){e.newSaving=!0,n.debug(e.newSaving),e.dIndex=t,e.product.$$save().then(function(){n.debug("Turn off the loader after saving."),e.newSaving=!1,angular.isDefined(e.dIndex)&&(e.closeSaving=!0,o.closePageDialog(e.dIndex))})}}]),angular.module("slatwalladmin").controller("globalSearch",["$scope","$log","$window","$timeout","$slatwall",function(e,t,n,o,a){e.keywords="",e.searchResultsOpen=!1,e.sidebarClass="sidebar",e.loading=!1,e.resultsFound=!0,e.searchResults={product:{title:"Products",resultNameFilter:function(e){return e.productName},results:[],id:function(e){return e.productID}},brand:{title:a.getRBKey("entity.Brands"),resultNameFilter:function(e){return e.brandName},results:[],id:function(e){return e.brandID}},account:{title:"Accounts",resultNameFilter:function(e){return e.firstName+" "+e.lastName},results:[],id:function(e){return e.accountID}},vendor:{title:"Vendors",resultNameFilter:function(e){return e.vendorName},results:[],id:function(e){return e.vendorID}}};var l,r=0;e.updateSearchResults=function(){e.loading=!0,e.showResults(),l&&o.cancel(l),l=o(function(){if(""===e.keywords)e.hideResults();else{e.showResults(),r=Object.keys(e.searchResults).length;for(var t in e.searchResults)(function(t){var n=a.getEntity(t,{keywords:e.keywords,pageShow:4,deferkey:"global-search-"+t});n.then(function(n){e.searchResults[t].results=[],e.searchResults[t].title=a.getRBKey("entity."+t.toLowerCase()+"_plural");for(var o in n.pageRecords)e.searchResults[t].results.push({name:e.searchResults[t].resultNameFilter(n.pageRecords[o]),link:"?slatAction=entity.detail"+t+"&"+t+"ID="+e.searchResults[t].id(n.pageRecords[o])});if(r--,0==r){e.loading=!1;var l=!1;for(var i in e.searchResults)if(e.searchResults[i].results.length){l=!0;break}e.resultsFound=l}})})(t)}},500)},e.showResults=function(){e.searchResultsOpen=!0,e.sidebarClass="sidebar s-search-width",n.onclick=function(t){var n=t.target.parentElement.offsetParent.classList.contains("sidebar");n||(e.hideResults(),e.$apply())}},e.hideResults=function(){e.searchResultsOpen=!1,e.sidebarClass="sidebar",e.search.$setPristine(),e.keywords="",n.onclick=null,e.loading=!1,e.resultsFound=!0;for(var t in e.searchResults)e.searchResults[t].results=[]}}]),angular.module("slatwalladmin").controller("pageDialog",["$scope","$location","$log","$anchorScroll","$slatwall","dialogService",function(e,t,n,o,a,l){e.$id="pageDialogController",e.pageDialogs=l.getPageDialogs(),e.scrollToTopOfDialog=function(){t.hash("/#topOfPageDialog"),o()},e.pageDialogStyle={"z-index":3e3}}]),angular.module("slatwalladmin").controller("preprocessaccount_addaccountpayment",["$scope","$compile",function(e,t){var n={aptCharge:"444df32dd2b0583d59a19f1b77869025",aptCredit:"444df32e9b448ea196c18c66e1454c46",aptAdjustment:"68e3fb57d8102b47acc0003906d16ddd"};e.totalAmountToApply=0,e.paymentTypeName=$.slatwall.rbKey("define.charge"),e.paymentTypeLock=!0,e.amount=0,e.updatePaymentType=function(){angular.forEach(e.appliedOrderPayment,function(t,o){e.paymentType!=n.aptAdjustment&&(t.paymentType=e.paymentType)}),e.paymentType==n.aptCharge?(e.paymentTypeName=$.slatwall.rbKey("define.charge"),e.paymentTypeLock=!0):e.paymentType==n.aptCredit?(e.paymentTypeName=$.slatwall.rbKey("define.credit"),e.paymentTypeLock=!0):e.paymentType==n.aptAdjustment&&(e.paymentTypeLock=!1,e.paymentTypeName=$.slatwall.rbKey("define.adjustment"),e.amount=0),e.updateSubTotal()},e.updateSubTotal=function(){e.totalAmountToApply=0,angular.forEach(e.appliedOrderPayment,function(t,o){void 0==t.amount||isNaN(t.amount)||(e.paymentType==n.aptCharge||e.paymentType==n.aptAdjustment?t.paymentType==n.aptCharge?e.totalAmountToApply+=parseFloat(t.amount):t.paymentType==n.aptCredit&&(e.totalAmountToApply-=parseFloat(t.amount)):e.paymentType==n.aptCredit&&(t.paymentType==n.aptCharge?e.totalAmountToApply-=parseFloat(t.amount):t.paymentType==n.aptCredit&&(e.totalAmountToApply+=parseFloat(t.amount))))}),e.amountUnapplied=Math.round(100*(e.amount-e.totalAmountToApply))/100,e.accountBalanceChange=parseFloat(e.amount),e.paymentType==n.aptCharge?e.accountBalanceChange=parseFloat(-1*e.accountBalanceChange):e.paymentType==n.aptAdjustment&&(e.accountBalanceChange+=parseFloat(e.amountUnapplied))}}]),angular.module("slatwalladmin").controller("routerController",["$scope","$routeParams","$location","$log","partialsPath","baseURL",function(e,t,n,o,a,l){e.$id="routerController",e.partialRoute="",o.debug(t),o.debug(n);var r=n.path();e.controllerType=r.split("/")[1];"entity"===e.controllerType&&(e.entityName=t.entityName,angular.isDefined(t.entityID)&&(e.entityID=t.entityID||""))}]);
//# sourceMappingURL=all.min.js.map