{"version":3,"names":[],"mappings":"","sources":["services/collectionservice.js"],"sourcesContent":["/*collection service is used to maintain the state of the ui*/\n'use strict';\nangular.module('slatwalladmin').factory('collectionService', [\n    '$filter',\n    '$log',\n    function ($filter, $log) {\n        /*properties*/\n        var _collection = null;\n        var _collectionConfig = null;\n        var _filterPropertiesList = {};\n        var _filterCount = 0;\n        var _orderBy = $filter('orderBy');\n        var collectionService = {\n            setFilterCount: function (number) {\n                $log.debug('incrementFilterCount');\n                _filterCount = number;\n            },\n            getFilterCount: function () {\n                return _filterCount;\n            },\n            getColumns: function () {\n                return _collection.collectionConfig.columns;\n            },\n            getFilterPropertiesList: function () {\n                return _filterPropertiesList;\n            },\n            getFilterPropertiesListByBaseEntityAlias: function (baseEntityAlias) {\n                return _filterPropertiesList[baseEntityAlias];\n            },\n            setFilterPropertiesList: function (value, key) {\n                if (angular.isUndefined(_filterPropertiesList[key])) {\n                    _filterPropertiesList[key] = value;\n                }\n            },\n            stringifyJSON: function (jsonObject) {\n                var jsonString = angular.toJson(jsonObject);\n                return jsonString;\n            },\n            removeFilterItem: function (filterItem, filterGroup) {\n                filterGroup.pop(filterGroup.indexOf(filterItem));\n            },\n            selectFilterItem: function (filterItem) {\n                if (filterItem.$$isClosed) {\n                    for (var i in filterItem.$$siblingItems) {\n                        filterItem.$$siblingItems[i].$$isClosed = true;\n                        filterItem.$$siblingItems[i].$$disabled = true;\n                    }\n                    filterItem.$$isClosed = false;\n                    filterItem.$$disabled = false;\n                    filterItem.setItemInUse(true);\n                }\n                else {\n                    for (var i in filterItem.$$siblingItems) {\n                        filterItem.$$siblingItems[i].$$disabled = false;\n                    }\n                    filterItem.$$isClosed = true;\n                    filterItem.setItemInUse(false);\n                }\n            },\n            selectFilterGroupItem: function (filterGroupItem) {\n                if (filterGroupItem.$$isClosed) {\n                    for (var i in filterGroupItem.$$siblingItems) {\n                        filterGroupItem.$$siblingItems[i].$$disabled = true;\n                    }\n                    filterGroupItem.$$isClosed = false;\n                    filterGroupItem.$$disabled = false;\n                }\n                else {\n                    for (var i in filterGroupItem.$$siblingItems) {\n                        filterGroupItem.$$siblingItems[i].$$disabled = false;\n                    }\n                    filterGroupItem.$$isClosed = true;\n                }\n                filterGroupItem.setItemInUse(!filterGroupItem.$$isClosed);\n            },\n            newFilterItem: function (filterItemGroup, setItemInUse, prepareForFilterGroup) {\n                if (angular.isUndefined(prepareForFilterGroup)) {\n                    prepareForFilterGroup = false;\n                }\n                var filterItem = {\n                    displayPropertyIdentifier: \"\",\n                    propertyIdentifier: \"\",\n                    comparisonOperator: \"\",\n                    value: \"\",\n                    $$disabled: false,\n                    $$isClosed: true,\n                    $$isNew: true,\n                    $$siblingItems: filterItemGroup,\n                    setItemInUse: setItemInUse\n                };\n                if (filterItemGroup.length !== 0) {\n                    filterItem.logicalOperator = \"AND\";\n                }\n                if (prepareForFilterGroup === true) {\n                    filterItem.$$prepareForFilterGroup = true;\n                }\n                filterItemGroup.push(filterItem);\n                this.selectFilterItem(filterItem);\n            },\n            newFilterGroupItem: function (filterItemGroup, setItemInUse) {\n                var filterGroupItem = {\n                    filterGroup: [],\n                    $$disabled: \"false\",\n                    $$isClosed: \"true\",\n                    $$siblingItems: filterItemGroup,\n                    $$isNew: \"true\",\n                    setItemInUse: setItemInUse\n                };\n                if (filterItemGroup.length !== 0) {\n                    filterGroupItem.logicalOperator = \"AND\";\n                }\n                filterItemGroup.push(filterGroupItem);\n                collectionService.selectFilterGroupItem(filterGroupItem);\n                this.newFilterItem(filterGroupItem.filterGroup, setItemInUse);\n            },\n            transplantFilterItemIntoFilterGroup: function (filterGroup, filterItem) {\n                var filterGroupItem = {\n                    filterGroup: [],\n                    $$disabled: \"false\",\n                    $$isClosed: \"true\",\n                    $$isNew: \"true\"\n                };\n                if (angular.isDefined(filterItem.logicalOperator)) {\n                    filterGroupItem.logicalOperator = filterItem.logicalOperator;\n                    delete filterItem.logicalOperator;\n                }\n                filterGroupItem.setItemInUse = filterItem.setItemInUse;\n                filterGroupItem.$$siblingItems = filterItem.$$siblingItems;\n                filterItem.$$siblingItems = [];\n                filterGroup.pop(filterGroup.indexOf(filterItem));\n                filterItem.$$prepareForFilterGroup = false;\n                filterGroupItem.filterGroup.push(filterItem);\n                filterGroup.push(filterGroupItem);\n            },\n            formatFilterPropertiesList: function (filterPropertiesList, propertyIdentifier) {\n                $log.debug('format Filter Properties List arguments 2');\n                $log.debug(filterPropertiesList);\n                $log.debug(propertyIdentifier);\n                var simpleGroup = {\n                    $$group: 'simple',\n                    displayPropertyIdentifier: '-----------------'\n                };\n                filterPropertiesList.data.push(simpleGroup);\n                var drillDownGroup = {\n                    $$group: 'drilldown',\n                    displayPropertyIdentifier: '-----------------'\n                };\n                filterPropertiesList.data.push(drillDownGroup);\n                var compareCollections = {\n                    $$group: 'compareCollections',\n                    displayPropertyIdentifier: '-----------------'\n                };\n                filterPropertiesList.data.push(compareCollections);\n                var attributeCollections = {\n                    $$group: 'attribute',\n                    displayPropertyIdentifier: '-----------------'\n                };\n                filterPropertiesList.data.push(attributeCollections);\n                for (var i in filterPropertiesList.data) {\n                    if (angular.isDefined(filterPropertiesList.data[i].ormtype)) {\n                        if (angular.isDefined(filterPropertiesList.data[i].attributeID)) {\n                            filterPropertiesList.data[i].$$group = 'attribute';\n                        }\n                        else {\n                            filterPropertiesList.data[i].$$group = 'simple';\n                        }\n                    }\n                    if (angular.isDefined(filterPropertiesList.data[i].fieldtype)) {\n                        if (filterPropertiesList.data[i].fieldtype === 'id') {\n                            filterPropertiesList.data[i].$$group = 'simple';\n                        }\n                        if (filterPropertiesList.data[i].fieldtype === 'many-to-one') {\n                            filterPropertiesList.data[i].$$group = 'drilldown';\n                        }\n                        if (filterPropertiesList.data[i].fieldtype === 'many-to-many' || filterPropertiesList.data[i].fieldtype === 'one-to-many') {\n                            filterPropertiesList.data[i].$$group = 'compareCollections';\n                        }\n                    }\n                    filterPropertiesList.data[i].propertyIdentifier = propertyIdentifier + '.' + filterPropertiesList.data[i].name;\n                }\n                filterPropertiesList.data = _orderBy(filterPropertiesList.data, ['-$$group', 'propertyIdentifier'], false);\n            },\n            orderBy: function (propertiesList, predicate, reverse) {\n                return _orderBy(propertiesList, predicate, reverse);\n            }\n        };\n        return collectionService;\n    }\n]);\n\n//# sourceMappingURL=../services/collectionservice.js.map"],"file":"services/collectionservice.js","sourceRoot":"/source/"}