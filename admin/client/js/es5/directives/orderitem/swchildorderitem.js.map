{"version":3,"names":[],"mappings":"","sources":["directives/orderitem/swchildorderitem.js"],"sourcesContent":["'use strict';\nangular.module('slatwalladmin').directive('swChildOrderItem', ['$log', '$http', '$compile', '$templateCache', '$slatwall', 'partialsPath', function ($log, $http, $compile, $templateCache, $slatwall, partialsPath) {\n    return {\n        restrict: \"A\",\n        scope: {\n            orderItem: \"=\",\n            orderId: \"@\",\n            childOrderItems: \"=\",\n            attributes: \"=\"\n        },\n        templateUrl: partialsPath + \"childorderitem.html\",\n        link: function (scope, element, attr) {\n            var columnsConfig = [\n                {\n                    \"isDeletable\": false,\n                    \"isExportable\": true,\n                    \"propertyIdentifier\": \"_orderitem.orderItemID\",\n                    \"ormtype\": \"id\",\n                    \"isVisible\": true,\n                    \"isSearchable\": true,\n                    \"title\": \"Order Item ID\"\n                },\n                {\n                    \"title\": \"Order Item Type\",\n                    \"propertyIdentifier\": \"_orderitem.orderItemType\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Order Item Price\",\n                    \"propertyIdentifier\": \"_orderitem.price\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Sku Name\",\n                    \"propertyIdentifier\": \"_orderitem.sku.skuName\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Sku Price\",\n                    \"propertyIdentifier\": \"_orderitem.skuPrice\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Sku ID\",\n                    \"propertyIdentifier\": \"_orderitem.sku.skuID\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"SKU Code\",\n                    \"propertyIdentifier\": \"_orderitem.sku.skuCode\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Product ID\",\n                    \"propertyIdentifier\": \"_orderitem.sku.product.productID\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Product Name\",\n                    \"propertyIdentifier\": \"_orderitem.sku.product.productName\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Product Description\",\n                    \"propertyIdentifier\": \"_orderitem.sku.product.productDescription\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Image File Name\",\n                    \"propertyIdentifier\": \"_orderitem.sku.imageFile\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"propertyIdentifier\": \"_orderitem.sku.skuPrice\",\n                    \"ormtype\": \"string\"\n                },\n                {\n                    \"title\": \"Product Type\",\n                    \"propertyIdentifier\": \"_orderitem.sku.product.productType\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"propertyIdentifier\": \"_orderitem.sku.baseProductType\",\n                    \"persistent\": false\n                },\n                {\n                    \"title\": \"Qty.\",\n                    \"propertyIdentifier\": \"_orderitem.quantity\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Fulfillment Method Name\",\n                    \"propertyIdentifier\": \"_orderitem.orderFulfillment.fulfillmentMethod.fulfillmentMethodName\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Fulfillment ID\",\n                    \"propertyIdentifier\": \"_orderitem.orderFulfillment.orderFulfillmentID\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Fulfillment Method Type\",\n                    \"propertyIdentifier\": \"_orderitem.orderFulfillment.fulfillmentMethod.fulfillmentMethodType\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"propertyIdentifier\": \"_orderitem.orderFulfillment.pickupLocation.primaryAddress.address\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Street Address\",\n                    \"propertyIdentifier\": \"_orderitem.orderFulfillment.shippingAddress.streetAddress\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Street Address 2\",\n                    \"propertyIdentifier\": \"_orderitem.orderFulfillment.shippingAddress.street2Address\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Postal Code\",\n                    \"propertyIdentifier\": \"_orderitem.orderFulfillment.shippingAddress.postalCode\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"City\",\n                    \"propertyIdentifier\": \"_orderitem.orderFulfillment.shippingAddress.city\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"State\",\n                    \"propertyIdentifier\": \"_orderitem.orderFulfillment.shippingAddress.stateCode\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Country\",\n                    \"propertyIdentifier\": \"_orderitem.orderFulfillment.shippingAddress.countryCode\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"title\": \"Total\",\n                    \"propertyIdentifier\": \"_orderitem.itemTotal\",\n                    \"persistent\": false\n                },\n                {\n                    \"title\": \"Discount Amount\",\n                    \"propertyIdentifier\": \"_orderitem.discountAmount\",\n                    \"persistent\": false\n                },\n                {\n                    \"propertyIdentifier\": \"_orderitem.extendedPrice\",\n                    \"persistent\": false\n                },\n                {\n                    \"propertyIdentifier\": \"_orderitem.productBundleGroup.amount\"\n                },\n                {\n                    \"title\": \"Product Bundle Group\",\n                    \"propertyIdentifier\": \"_orderitem.productBundleGroup.productBundleGroupID\",\n                    \"isVisible\": true,\n                    \"isDeletable\": true\n                },\n                {\n                    \"propertyIdentifier\": \"_orderitem.productBundleGroup.amountType\"\n                },\n                {\n                    \"propertyIdentifier\": \"_orderitem.productBundleGroupPrice\",\n                    \"persistent\": false\n                },\n                {\n                    \"propertyIdentifier\": \"_orderitem.productBundlePrice\",\n                    \"persistent\": false\n                }\n            ];\n            //add attributes to the column config\n            angular.forEach(scope.attributes, function (attribute) {\n                var attributeColumn = {\n                    propertyIdentifier: \"_orderitem.\" + attribute.attributeCode,\n                    attributeID: attribute.attributeID,\n                    attributeSetObject: \"orderItem\"\n                };\n                columnsConfig.push(attributeColumn);\n            });\n            var filterGroupsConfig = [\n                {\n                    \"filterGroup\": [\n                        {\n                            \"propertyIdentifier\": \"_orderitem.parentOrderItem.orderItemID\",\n                            \"comparisonOperator\": \"=\",\n                            \"value\": scope.orderItem.$$getID(),\n                        }\n                    ]\n                }\n            ];\n            var options = {\n                columnsConfig: angular.toJson(columnsConfig),\n                filterGroupsConfig: angular.toJson(filterGroupsConfig),\n                allRecords: true\n            };\n            //hide the children on click\n            scope.hideChildren = function (orderItem) {\n                //Set all child order items to clicked = false.\n                angular.forEach(scope.childOrderItems, function (child) {\n                    console.dir(child);\n                    child.hide = !child.hide;\n                    scope.orderItem.clicked = !scope.orderItem.clicked;\n                });\n            };\n            /**\n             * Returns a list of child order items.\n             */\n            scope.getChildOrderItems = function (orderItem) {\n                orderItem.clicked = true;\n                if (!scope.orderItem.childItemsRetrieved) {\n                    scope.orderItem.childItemsRetrieved = true;\n                    var orderItemsPromise = $slatwall.getEntity('orderItem', options);\n                    orderItemsPromise.then(function (value) {\n                        var collectionConfig = {};\n                        collectionConfig.columns = columnsConfig;\n                        collectionConfig.baseEntityName = 'SlatwallOrderItem';\n                        collectionConfig.baseEntityAlias = '_orderitem';\n                        var childOrderItems = $slatwall.populateCollection(value.records, collectionConfig);\n                        angular.forEach(childOrderItems, function (childOrderItem) {\n                            childOrderItem.hide = false;\n                            childOrderItem.depth = orderItem.depth + 1;\n                            childOrderItem.data.parentOrderItem = orderItem;\n                            childOrderItem.data.parentOrderItemQuantity = scope.orderItem.data.quantity / scope.orderItem.data.parentOrderItemQuantity;\n                            scope.childOrderItems.splice(scope.childOrderItems.indexOf(orderItem) + 1, 0, childOrderItem);\n                            childOrderItem.data.productBundleGroupPercentage = 1;\n                            if (childOrderItem.data.productBundleGroup.data.amountType === 'skuPricePercentageIncrease') {\n                                childOrderItem.data.productBundleGroupPercentage = 1 + childOrderItem.data.productBundleGroup.data.amount / 100;\n                            }\n                            else if (childOrderItem.data.productBundleGroup.data.amountType === 'skuPricePercentageDecrease') {\n                                childOrderItem.data.productBundleGroupPercentage = 1 - childOrderItem.data.productBundleGroup.data.amount / 100;\n                            }\n                        });\n                    });\n                }\n            };\n        }\n    };\n}]);\n\n//# sourceMappingURL=../../directives/orderitem/swchildorderitem.js.map"],"file":"directives/orderitem/swchildorderitem.js","sourceRoot":"/source/"}