"use strict";angular.module("slatwalladmin",["ngSlatwall","ui.bootstrap","ngAnimate","ngRoute"]).config(["$provide","$logProvider","$filterProvider","$httpProvider","$routeProvider","$injector","$locationProvider","datepickerConfig","datepickerPopupConfig",function(e,t,a,n,r,o,i,l,s){l.showWeeks=!1,l.format="MMM dd, yyyy hh:mm a",s.toggleWeeksText=null,slatwallAngular.hashbang&&i.html5Mode(!1).hashPrefix("!"),e.constant("baseURL",$.slatwall.getConfig().baseURL);var u=$.slatwall.getConfig().baseURL+"/admin/client/partials/";e.constant("partialsPath",u),e.constant("productBundlePartialsPath",u+"productbundle/"),angular.forEach(slatwallAngular.constantPaths,function(t,a){var n=t.charAt(0).toLowerCase()+t.slice(1)+"PartialsPath",r=u+t.toLowerCase()+"/";e.constant(n,r)}),t.debugEnabled($.slatwall.getConfig().debugFlag),a.register("likeFilter",function(){return function(e){return angular.isDefined(e)&&angular.isString(e)?e.replace(new RegExp("%","g"),""):void 0}}),a.register("truncate",function(){return function(e,t,a){if(isNaN(t))return e;if(0>=t)return"";if(e&&e.length>t){if(e=e.substring(0,t),a)for(;" "===e.charAt(e.length-1);)e=e.substr(0,e.length-1);else{var n=e.lastIndexOf(" ");-1!==n&&(e=e.substr(0,n))}return e+"..."}return e}}),n.interceptors.push("slatwallInterceptor"),r.when("/entity/:entityName/",{template:function(e){var t=o.has("sw"+e.entityName+"ListDirective");return t?"<sw-"+e.entityName.toLowerCase()+"-list>":"<sw-list></sw-list>"},controller:"routerController"}).when("/entity/:entityName/:entityID",{template:function(e){var t=o.has("sw"+e.entityName+"DetailDirective");return t?"<sw-"+e.entityName.toLowerCase()+"-detail>":"<sw-detail></sw-detail>"},controller:"routerController"}).otherwise({templateUrl:$.slatwall.getConfig().baseURL+"/admin/client/js/partials/otherwise.html"})}]).run(["$rootScope","$filter","$anchorScroll","$slatwall","dialogService",function(e,t,a,n,r){a.yOffset=100,e.openPageDialog=function(e){r.addPageDialog(e)},e.closePageDialog=function(e){r.removePageDialog(e)},e.loadedResourceBundle=!1,e.loadedResourceBundle=n.hasResourceBundle();var o=e.$watch("loadedResourceBundle",function(t,a){t!==a&&(e.$broadcast("hasResourceBundle"),o())})}]).filter("entityRBKey",["$slatwall",function(e){return function(t){return angular.isDefined(t)&&angular.isString(t)?(t=t.replace("_","").toLowerCase(),t=e.getRBKey("entity."+t)):void 0}}]),angular.module("slatwalladmin").factory("alertService",["$timeout",function(e){var t=[],a={addAlert:function(a){t.push(a),e(function(){t.splice(0,1)},3500)},addAlerts:function(a){for(var n in a)t.push(a[n]),e(function(){t.splice(0,1)},3500)},formatMessagesToAlerts:function(t){var a=[];for(var n in t){var r={msg:t[n].message,type:t[n].messageType};a.push(r),"success"===r.type||"error"===r.type?(e(function(){r.fade=!0},3500),r.dismissable=!1):(r.fade=!1,r.dismissable=!0)}return a},getAlerts:function(){return t},removeAlert:function(e){for(var a in t)t[a]===e&&delete t[a]},removeOldestAlert:function(){_alert.splice(0,1)}};return a}]),angular.module("slatwalladmin").factory("collectionService",["$filter","$log",function(e,t){var a=null,n={},r=0,o=e("orderBy"),i={setFilterCount:function(e){t.debug("incrementFilterCount"),r=e},getFilterCount:function(){return r},getColumns:function(){return a.collectionConfig.columns},getFilterPropertiesList:function(){return n},getFilterPropertiesListByBaseEntityAlias:function(e){return n[e]},setFilterPropertiesList:function(e,t){angular.isUndefined(n[t])&&(n[t]=e)},stringifyJSON:function(e){var t=angular.toJson(e);return t},removeFilterItem:function(e,t){t.pop(t.indexOf(e))},selectFilterItem:function(e){if(e.$$isClosed){for(var t in e.$$siblingItems)e.$$siblingItems[t].$$isClosed=!0,e.$$siblingItems[t].$$disabled=!0;e.$$isClosed=!1,e.$$disabled=!1,e.setItemInUse(!0)}else{for(var t in e.$$siblingItems)e.$$siblingItems[t].$$disabled=!1;e.$$isClosed=!0,e.setItemInUse(!1)}},selectFilterGroupItem:function(e){if(e.$$isClosed){for(var t in e.$$siblingItems)e.$$siblingItems[t].$$disabled=!0;e.$$isClosed=!1,e.$$disabled=!1}else{for(var t in e.$$siblingItems)e.$$siblingItems[t].$$disabled=!1;e.$$isClosed=!0}e.setItemInUse(!e.$$isClosed)},newFilterItem:function(e,t,a){angular.isUndefined(a)&&(a=!1);var n={displayPropertyIdentifier:"",propertyIdentifier:"",comparisonOperator:"",value:"",$$disabled:!1,$$isClosed:!0,$$isNew:!0,$$siblingItems:e,setItemInUse:t};0!==e.length&&(n.logicalOperator="AND"),a===!0&&(n.$$prepareForFilterGroup=!0),e.push(n),this.selectFilterItem(n)},newFilterGroupItem:function(e,t){var a={filterGroup:[],$$disabled:"false",$$isClosed:"true",$$siblingItems:e,$$isNew:"true",setItemInUse:t};0!==e.length&&(a.logicalOperator="AND"),e.push(a),i.selectFilterGroupItem(a),this.newFilterItem(a.filterGroup,t)},transplantFilterItemIntoFilterGroup:function(e,t){var a={filterGroup:[],$$disabled:"false",$$isClosed:"true",$$isNew:"true"};angular.isDefined(t.logicalOperator)&&(a.logicalOperator=t.logicalOperator,delete t.logicalOperator),a.setItemInUse=t.setItemInUse,a.$$siblingItems=t.$$siblingItems,t.$$siblingItems=[],e.pop(e.indexOf(t)),t.$$prepareForFilterGroup=!1,a.filterGroup.push(t),e.push(a)},formatFilterPropertiesList:function(e,a){t.debug("format Filter Properties List arguments 2"),t.debug(e),t.debug(a);var n={$$group:"simple",displayPropertyIdentifier:"-----------------"};e.data.push(n);var r={$$group:"drilldown",displayPropertyIdentifier:"-----------------"};e.data.push(r);var i={$$group:"compareCollections",displayPropertyIdentifier:"-----------------"};e.data.push(i);var l={$$group:"attribute",displayPropertyIdentifier:"-----------------"};e.data.push(l);for(var s in e.data)angular.isDefined(e.data[s].ormtype)&&(e.data[s].$$group=angular.isDefined(e.data[s].attributeID)?"attribute":"simple"),angular.isDefined(e.data[s].fieldtype)&&("id"===e.data[s].fieldtype&&(e.data[s].$$group="simple"),"many-to-one"===e.data[s].fieldtype&&(e.data[s].$$group="drilldown"),("many-to-many"===e.data[s].fieldtype||"one-to-many"===e.data[s].fieldtype)&&(e.data[s].$$group="compareCollections")),e.data[s].propertyIdentifier=a+"."+e.data[s].name;e.data=o(e.data,["-$$group","propertyIdentifier"],!1)},orderBy:function(e,t,a){return o(e,t,a)}};return i}]),angular.module("slatwalladmin").factory("dialogService",["partialsPath",function(e){var t=[],a={addPageDialog:function(a){var n={path:e+a+".html"};t.push(n)},removePageDialog:function(e){t.splice(e,1)},getPageDialogs:function(){return t}};return a}]),angular.module("slatwalladmin").factory("formService",["$log",function(e){function t(e,t,a){this.name=e,this.object=t,this.editing=a}var a={},n={},r={setPristinePropertyValue:function(e,t){n[e]=t},getPristinePropertyValue:function(e){return n[e]},clearForm:function(t){e.debug("clear form"),e.debug(t);for(var a in t)"$"!==a.charAt(0)&&e.debug(t[a])},setForm:function(e){a[e.name]=e},getForm:function(e){return a[e]},getForms:function(){return a},getFormsByObjectName:function(e){var t=[];for(var n in a)angular.isDefined(a[n].$$swFormInfo.object)&&a[n].$$swFormInfo.object.metaData.className===e&&t.push(a[n]);return t},createForm:function(e,a,n){var r=new t(e,a,n);return this.setForm(r),r},resetForm:function(e){for(var t in e)"$"!==t.charAt(0)&&(e[t].$setViewValue(angular.isDefined(this.getPristinePropertyValue(t))?this.getPristinePropertyValue(t):""),e[t].$render());e.$submitted=!1,e.$setPristine()}};return r}]),angular.module("slatwalladmin").factory("metadataService",["$filter","$log",function(e,t){var a={},n=e("orderBy"),r={getPropertiesList:function(){return a},getPropertiesListByBaseEntityAlias:function(e){return a[e]},setPropertiesList:function(e,t){a[t]=e},formatPropertiesList:function(e,a){var r={$$group:"simple"};e.data.push(r);var o={$$group:"drilldown"};e.data.push(o);var i={$$group:"compareCollections"};e.data.push(i);var l={$$group:"attribute"};e.data.push(l);for(var s in e.data)angular.isDefined(e.data[s].ormtype)&&(e.data[s].$$group=angular.isDefined(e.data[s].attributeID)?"attribute":"simple"),angular.isDefined(e.data[s].fieldtype)&&("id"===e.data[s].fieldtype&&(e.data[s].$$group="simple"),"many-to-one"===e.data[s].fieldtype&&(e.data[s].$$group="drilldown"),("many-to-many"===e.data[s].fieldtype||"one-to-many"===e.data[s].fieldtype)&&(e.data[s].$$group="compareCollections")),e.data[s].propertyIdentifier=a+"."+e.data[s].name;for(var u=[],s=0;s<=e.data.length-1;s++)-1!=e.data[s].propertyIdentifier.indexOf(".undefined")?(t.debug("removing: "+e.data[s].displayPropertyIdentifier),e.data[s].displayPropertyIdentifier="hide"):(u.push(e.data[s]),t.debug(e.data[s]));u.sort,e.data=u,t.debug("----------------------PropertyList\n\n\n\n\n"),e.data=n(e.data,["propertyIdentifier"],!1)},orderBy:function(e,t,a){return n(e,t,a)}};return r}]),angular.module("slatwalladmin").factory("paginationService",[function(){var e=[{display:10,value:10},{display:20,value:20},{display:50,value:50},{display:250,value:250},{display:"Auto",value:"Auto"}],t=10,a=1,n=0,r=0,o=0,i=0,l={getTotalPages:function(){return i},setTotalPages:function(e){i=e},getPageStart:function(){return n},setPageStart:function(e){n=e},getPageEnd:function(){return r},setPageEnd:function(e){r=e},getRecordsCount:function(){return o},setRecordsCount:function(e){o=e},getPageShowOptions:function(){return e},setPageShowOptions:function(t){e=t},getPageShow:function(){return t},setPageShow:function(e){t=e},getCurrentPage:function(){return a},setCurrentPage:function(e){a=e},previousPage:function(){this.hasPrevious()||(a=this.getCurrentPage()-1)},nextPage:function(){this.hasNext()||(a=this.getCurrentPage()+1)},hasPrevious:function(){return l.getPageStart()<=1?!0:!1},hasNext:function(){return l.getPageEnd()===l.getRecordsCount()?!0:!1}};return l}]),angular.module("slatwalladmin").factory("productBundleService",["$log","$slatwall","utilityService",function(e,t,a){var n={decorateProductBundleGroup:function(e){e.data.$$editing=!0;var t={$$setMinimumQuantity:function(e){(0>e||null===e)&&(this.minimumQuantity=0),e>this.maximumQuantity&&(this.maximumQuantity=e)},$$setMaximumQuantity:function(e){(1>e||null===e)&&(this.maximumQuantity=1),this.maximumQuantity<this.minimumQuantity&&(this.minimumQuantity=this.maximumQuantity)},$$setActive:function(e){this.active=e},$$toggleEdit:function(){this.$$editing=angular.isUndefined(this.$$editing)||this.$$editing===!1?!0:!1}};angular.extend(e.data,t)},formatProductBundleGroupFilters:function(t,n){if(e.debug("formatProductBundleGroupFilters"),e.debug(n),"sku"===n.value)for(var r in t)t[r].name=t[r][n.value+"Code"],t[r].type=n.name,t[r].entityType=n.value,t[r].propertyIdentifier="_sku.skuID";else for(var r in t)t[r].name=t[r][n.value+"Name"],t[r].type=n.name,t[r].entityType=n.value,t[r].propertyIdentifier="brand"===n.value||"productType"===n.value?"_sku.product."+n.value+"."+n.value+"ID":"_sku."+n.value+"."+n.value+"ID";return t=a.arraySorter(t,"name"),e.debug(t),t}};return n}]),angular.module("slatwalladmin").factory("slatwallInterceptor",["$q","$log","alertService",function(e,t,a){var n={request:function(e){if(t.debug("request"),"GET"==e.method&&-1==e.url.indexOf(".html")&&-1==e.url.indexOf(".json")){e.method="POST",e.data={};var a={};angular.isDefined(e.params)&&(a=e.params);var n={};n.serializedJsonData=angular.toJson(a),n.context="GET",e.data=$.param(n),delete e.params,e.headers["Content-Type"]="application/x-www-form-urlencoded"}return e},response:function(e){t.debug("response");var n=e.data.messages,r=a.formatMessagesToAlerts(n);return a.addAlerts(r),e},requestError:function(a){return t.debug("requestError"),e.reject(a)},responseError:function(n){if(t.debug("responseReject"),angular.isDefined(n.status)&&404!==n.status)if(angular.isDefined(n.data)&&angular.isDefined(n.data.messages)){var r=n.data.messages,o=a.formatMessagesToAlerts(r);a.addAlerts(o)}else{var i={msg:"there was error retrieving data",type:"error"};a.addAlert(i)}return e.reject(n)}};return n}]),angular.module("slatwalladmin").factory("utilityService",[function(){var e={createID:function(e){for(var e=e||26,t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;e>n;n++)t+=a.charAt(Math.floor(Math.random()*a.length));return t},listFind:function(e,t,a){angular.isUndefined(a)&&(a=",");for(var n=e.split(a),r=-1,o=0;o<n.length;o++){var i=n[o];if(i==t){r=o;break}}},listLen:function(e,t){angular.isUndefined(t)&&(t=",");var a=e.split(t);return a.length},arraySorter:function(e,t){return e.sort(function(e,a){return angular.isDefined(t)?e[t]<a[t]?-1:e[t]>a[t]?1:0:a>e?-1:e>a?1:0}),e}};return e}]),angular.module("slatwalladmin").controller("alertController",["$scope","alertService",function(e,t){e.$id="alertController",e.alerts=t.getAlerts()}]),angular.module("slatwalladmin").controller("collections",["$scope","$location","$log","$timeout","$slatwall","collectionService","metadataService","paginationService",function(e,t,a,n,r,o,i,l){e.$id="collectionsController";var s=function(){for(var e={},t=window.location.search.substring(1),a=t.split("&"),n=0;n<a.length;n++){var r=a[n].split("=");if("undefined"==typeof e[r[0]])e[r[0]]=r[1];else if("string"==typeof e[r[0]]){var o=[e[r[0]],r[1]];e[r[0]]=o}else e[r[0]].push(r[1])}return e}();e.collectionID=s.collectionID,e.currentPage=l.getCurrentPage(),e.pageShow=l.getPageShow(),e.pageStart=l.getPageStart,e.pageEnd=l.getPageEnd,e.recordsCount=l.getRecordsCount,e.autoScrollPage=1,e.autoScrollDisabled=!1,e.appendToCollection=function(){if("Auto"===e.pageShow&&(a.debug("AppendToCollection"),e.autoScrollPage<e.collection.totalPages)){e.autoScrollDisabled=!0,e.autoScrollPage++;var t=r.getEntity("collection",{id:e.collectionID,currentPage:e.autoScrollPage,pageShow:50});t.then(function(t){e.collection.pageRecords=e.collection.pageRecords.concat(t.pageRecords),e.autoScrollDisabled=!1},function(e){})}},e.keywords="",e.loadingCollection=!1;var u;e.searchCollection=function(t){u&&n.cancel(u),u=n(function(){a.debug("search with keywords"),a.debug(e.keywords),l.setCurrentPage(1),e.loadingCollection=!0,e.getCollection()},500)},e.getCollection=function(){var t=50;"Auto"!==e.pageShow&&(t=e.pageShow);var a=r.getEntity("collection",{id:e.collectionID,currentPage:e.currentPage,pageShow:t,keywords:e.keywords});a.then(function(t){e.collection=t,e.collectionInitial=angular.copy(e.collection),angular.isUndefined(e.collectionConfig)&&(e.collectionConfig=angular.fromJson(e.collection.collectionConfig)),angular.isUndefined(e.collectionConfig.filterGroups)&&(e.collectionConfig.filterGroups=[{filterGroup:[]}]),o.setFilterCount(d()),e.loadingCollection=!1},function(e){})},e.getCollection();var c=e.$watch("collection",function(t,a){if(t!==a){if(angular.isUndefined(e.filterPropertiesList)){e.filterPropertiesList={};var n=r.getFilterPropertiesByBaseEntityName(e.collectionConfig.baseEntityAlias);n.then(function(t){i.setPropertiesList(t,e.collectionConfig.baseEntityAlias),e.filterPropertiesList[e.collectionConfig.baseEntityAlias]=i.getPropertiesListByBaseEntityAlias(e.collectionConfig.baseEntityAlias),i.formatPropertiesList(e.filterPropertiesList[e.collectionConfig.baseEntityAlias],e.collectionConfig.baseEntityAlias)})}c()}});e.setCollectionForm=function(t){e.collectionForm=t},e.collectionDetails={isOpen:!1,openCollectionDetails:function(){e.collectionDetails.isOpen=!0}},e.errorMessage={};var d=function(t){var a=0;angular.isDefined(t)||(t=e.collectionConfig.filterGroups[0].filterGroup);for(var n in t)if(t[n].$$isNew||angular.isDefined(t[n].filterGroup)){if(!angular.isDefined(t[n].filterGroup))break;a+=d(t[n].filterGroup)}else a++;return a};e.saveCollection=function(){n(function(){a.debug("saving Collection");var t="collection",n=e.collection;if(a.debug(e.collectionConfig),p(e.collectionForm)){var i=o.stringifyJSON(e.collectionConfig);a.debug(i);var s=angular.copy(n);s.collectionConfig=i,delete s.pageRecords;var u=r.saveEntity(t,n.collectionID,s);u.then(function(t){e.errorMessage={},l.setCurrentPage(1),e.getCollection(),e.collectionDetails.isOpen=!1},function(t){angular.forEach(t.errors,function(t,a){e.collectionForm[a].$invalid=!0,e.errorMessage[a]=t[0]})})}o.setFilterCount(d())})};var p=function(t){a.debug("validateForm");var n=!0;for(var r in t)if("$"!=r[0]){if(t[r].$invalid){n=!1;for(var o in t[r].$error)"required"==o&&(e.errorMessage[r]="This field is required")}t[r].$pristine&&t[r].$setViewValue(angular.isUndefined(t[r].$viewValue)?"":t[r].$viewValue)}return n};e.copyExistingCollection=function(){e.collection.collectionConfig=e.selectedExistingCollection},e.setSelectedExistingCollection=function(t){e.selectedExistingCollection=t},e.setSelectedFilterProperty=function(t){e.selectedFilterProperty=t},e.filterCount=o.getFilterCount}]),angular.module("slatwalladmin").controller("collectionsTabController",["$scope",function(e){}]),angular.module("slatwalladmin").controller("confirmationController",["$scope","$log","$modalInstance",function(e,t,a){e.deleteEntity=function(a){t.debug("Deleting an entity."),t.debug(e.entity),this.close()},e.close=function(){a.close()},e.cancel=function(){a.dismiss("cancel")}}]),angular.module("slatwalladmin").controller("create-bundle-controller",["$scope","$location","$log","$rootScope","$window","$slatwall","dialogService","alertService","productBundleService","formService","partialsPath",function(e,t,a,n,r,o,i,l,s,u,c){function d(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),a=t.exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}e.partialsPath=c,e.$id="create-bundle-controller",angular.isDefined(e.scrollToTopOfDialog)&&e.scrollToTopOfDialog();var p=d("productID"),g=function(){e.product=o.newProduct();var t=o.newBrand(),a=o.newProductType();e.product.$$setBrand(t),e.product.$$setProductType(a),e.product.$$addSku(),e.product.data.skus[0].data.productBundleGroups=[]};if(e.productBundleGroup,angular.isDefined(p)&&""!==p){var f=o.getProduct({id:p});f.promise.then(function(){a.debug(f.value),f.value.$$getSkus().then(function(){f.value.data.skus[0].$$getProductBundleGroups().then(function(){e.product=f.value,angular.forEach(e.product.data.skus[0].data.productBundleGroups,function(e){e.$$getProductBundleGroupType(),s.decorateProductBundleGroup(e),e.data.$$editing=!1})})})},g())}else g();e.saveProductBundle=function(t){e.newSaving=!0,a.debug(e.newSaving),e.dIndex=t,e.product.$$save().then(function(){a.debug("Turn off the loader after saving."),e.newSaving=!1,angular.isDefined(e.dIndex)&&(e.closeSaving=!0,n.closePageDialog(e.dIndex))})}}]),angular.module("slatwalladmin").controller("globalSearch",["$scope","$log","$window","$timeout","$slatwall",function(e,t,a,n,r){e.keywords="",e.searchResultsOpen=!1,e.sidebarClass="sidebar",e.loading=!1,e.resultsFound=!0,e.searchResults={product:{title:"Products",resultNameFilter:function(e){return e.productName},results:[],id:function(e){return e.productID}},brand:{title:r.getRBKey("entity.Brands"),resultNameFilter:function(e){return e.brandName},results:[],id:function(e){return e.brandID}},account:{title:"Accounts",resultNameFilter:function(e){return e.firstName+" "+e.lastName},results:[],id:function(e){return e.accountID}},vendor:{title:"Vendors",resultNameFilter:function(e){return e.vendorName},results:[],id:function(e){return e.vendorID}}};var o,i=0;e.updateSearchResults=function(){e.loading=!0,e.showResults(),o&&n.cancel(o),o=n(function(){if(""===e.keywords)e.hideResults();else{e.showResults(),i=Object.keys(e.searchResults).length;for(var t in e.searchResults)(function(t){var a=r.getEntity(t,{keywords:e.keywords,pageShow:4,deferkey:"global-search-"+t});a.then(function(a){e.searchResults[t].results=[],e.searchResults[t].title=r.getRBKey("entity."+t.toLowerCase()+"_plural");for(var n in a.pageRecords)e.searchResults[t].results.push({name:e.searchResults[t].resultNameFilter(a.pageRecords[n]),link:"?slatAction=entity.detail"+t+"&"+t+"ID="+e.searchResults[t].id(a.pageRecords[n])});if(i--,0==i){e.loading=!1;var o=!1;for(var l in e.searchResults)if(e.searchResults[l].results.length){o=!0;break}e.resultsFound=o}})})(t)}},500)},e.showResults=function(){e.searchResultsOpen=!0,e.sidebarClass="sidebar s-search-width",a.onclick=function(t){var a=t.target.parentElement.offsetParent.classList.contains("sidebar");a||(e.hideResults(),e.$apply())}},e.hideResults=function(){e.searchResultsOpen=!1,e.sidebarClass="sidebar",e.search.$setPristine(),e.keywords="",a.onclick=null,e.loading=!1,e.resultsFound=!0;for(var t in e.searchResults)e.searchResults[t].results=[]}}]),angular.module("slatwalladmin").controller("pageDialog",["$scope","$location","$log","$anchorScroll","$slatwall","dialogService",function(e,t,a,n,r,o){e.$id="pageDialogController",e.pageDialogs=o.getPageDialogs(),e.scrollToTopOfDialog=function(){t.hash("/#topOfPageDialog"),n()},e.pageDialogStyle={"z-index":3e3}}]),angular.module("slatwalladmin").controller("preprocessaccount_addaccountpayment",["$scope","$compile",function(e,t){var a={aptCharge:"444df32dd2b0583d59a19f1b77869025",aptCredit:"444df32e9b448ea196c18c66e1454c46",aptAdjustment:"68e3fb57d8102b47acc0003906d16ddd"};e.totalAmountToApply=0,e.paymentTypeName=$.slatwall.rbKey("define.charge"),e.paymentTypeLock=!0,e.amount=0,e.updatePaymentType=function(){angular.forEach(e.appliedOrderPayment,function(t,n){e.paymentType!=a.aptAdjustment&&(t.paymentType=e.paymentType)}),e.paymentType==a.aptCharge?(e.paymentTypeName=$.slatwall.rbKey("define.charge"),e.paymentTypeLock=!0):e.paymentType==a.aptCredit?(e.paymentTypeName=$.slatwall.rbKey("define.credit"),e.paymentTypeLock=!0):e.paymentType==a.aptAdjustment&&(e.paymentTypeLock=!1,e.paymentTypeName=$.slatwall.rbKey("define.adjustment"),e.amount=0),e.updateSubTotal()},e.updateSubTotal=function(){e.totalAmountToApply=0,angular.forEach(e.appliedOrderPayment,function(t,n){void 0==t.amount||isNaN(t.amount)||(e.paymentType==a.aptCharge||e.paymentType==a.aptAdjustment?t.paymentType==a.aptCharge?e.totalAmountToApply+=parseFloat(t.amount):t.paymentType==a.aptCredit&&(e.totalAmountToApply-=parseFloat(t.amount)):e.paymentType==a.aptCredit&&(t.paymentType==a.aptCharge?e.totalAmountToApply-=parseFloat(t.amount):t.paymentType==a.aptCredit&&(e.totalAmountToApply+=parseFloat(t.amount))))}),e.amountUnapplied=Math.round(100*(e.amount-e.totalAmountToApply))/100,e.accountBalanceChange=parseFloat(e.amount),e.paymentType==a.aptCharge?e.accountBalanceChange=parseFloat(-1*e.accountBalanceChange):e.paymentType==a.aptAdjustment&&(e.accountBalanceChange+=parseFloat(e.amountUnapplied))}}]),angular.module("slatwalladmin").controller("routerController",["$scope","$routeParams","$location","$log","partialsPath","baseURL",function(e,t,a,n,r,o){e.$id="routerController",e.partialRoute="",n.debug(t),n.debug(a);var i=a.path();e.controllerType=i.split("/")[1];"entity"===e.controllerType&&(e.entityName=t.entityName,angular.isDefined(t.entityID)&&(e.entityID=t.entityID||""))}]);
//# sourceMappingURL=all.min.js.map